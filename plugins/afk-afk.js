import db from '../lib/database.js'

// Ù‚Ù… Ø¨ØªØ¹Ø±ÙŠÙ Ø®Ø±ÙŠØ·Ø© Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø·ÙˆØ§Ø¨ÙŠØ± Ø§Ù„Ø²Ù…Ù†ÙŠØ© Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø¨ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© AFK
const afkCooldowns = new Map();

let handler = async (m, { text, conn }) => {
    let user = global.db.data.users[m.sender];

    // ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‚Ø¯ Ù‚Ø§Ù… Ø¨ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© AFK Ø¯Ø§Ø®Ù„ ÙØªØ±Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
    if (afkCooldowns.has(m.sender)) {
        let cooldownEnd = afkCooldowns.get(m.sender) + 1 * 60 * 1000; // 1 Ø¯Ù‚Ø§Ø¦Ù‚ ÙØªØ±Ø© Ø§Ù†ØªØ¸Ø§Ø±
        let remainingTime = cooldownEnd - Date.now();
        if (remainingTime > 0) {
            m.reply(`*Ù„Ø§ ÙŠÙ€Ù…Ù€ÙƒÙ€Ù†Ù€Ùƒ ØªÙ€Ø¹Ù€ÙŠÙ€ÙŠÙ€Ù† Ø­Ù€Ø§Ù„Ù€Ø© Ø§Ø®Ù€ØªÙ€ÙÙ€Ø§Ø¡ Ù…Ù€Ø±Ø© Ø£Ø®Ù€Ø±Ù‰ Ø­Ù€ØªÙ€Ù‰ Ø¨Ù€Ø¹Ù€Ø¯ ${Math.ceil(remainingTime / 1000 / 60)} Ø¯Ù‚Ù€ÙŠÙ€Ù‚Ù€Ø©.*`);
            return;
        }
    }

    String.fromCharCode(8206);
    let done = 'ğŸ’¤';
    m.react(done)
    user.afk = +new Date();
    user.afkReason = text;

    // Ù‚Ù… Ø¨ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ø²Ù…Ù†ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙƒÙˆÙ‚Øª Ø¢Ø®Ø± ØªØ¹ÙŠÙŠÙ† AFK Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
    afkCooldowns.set(m.sender, Date.now());

    m.reply(`
> *Ë¼ğŸ˜´Ë¹ Ø§Ø®Ù€Ù€Ù€Ù€Ù€Ù€ØªÙ€Ù€Ù€Ù€Ù€Ù€ÙÙ€Ù€Ù€Ù€Ù€Ù€Ø§Ø¡â•¿â†¶*
*â•®â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŸ¢Ù€*
*â”‡â€£ Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ù…ØªÙˆÙ‚Ù Ø­ØªÙ‰ ØªØ±Ø³Ù„ Ø±Ø³Ø§Ù„Ø©*  
*â”‡ğŸ‘¤â€£ Ù…Ù€Ù€Ø³Ù€Ù€ØªÙ€Ù€Ø®Ù€Ù€Ø¯Ù…â•¿â†¶*
*â”‡${conn.getName(m.sender)}*
*â•¯â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŸ¢Ù€*
> *Ë¼â“Ë¹ â€£ Ø§Ù„Ù€Ù€Ø³Ù€Ù€Ø¨Ù€Ù€Ø¨â•¿â†¶*\n> Ë¼â“Ë¹ â€£ ${text ? text : '*Ø¨Ù€Ù€Ù„Ø§ Ø³Ù€Ù€Ø¨Ù€Ù€Ø¨ Ø£Ùˆ Ù„Ù€Ù€Ù… ÙŠØ°ÙƒÙ€Ù€Ø± Ø³Ù€Ù€Ø¨Ù€Ù€Ø¨*'}`)
}
handler.help = ['afk <Ø§Ù„Ø³Ø¨Ø¨>']
handler.tags = ['fun']
handler.command = ['Ø§Ø®ØªÙØ§Ø¡','Ù…Ø£ÙÙƒ','ØªØ£ÙÙŠÙƒ','afk']
handler.group = true

export default handler
