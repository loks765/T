import { areJidsSameUser } from '@adiwajshing/baileys'
let toM = a => '@' + a.split('@')[0]
let handler = async (m, { conn, usedPrefix, command, text, participants, groupMetadata}) => {
    let who = m.mentionedJid && m.mentionedJid[0] ? m.mentionedJid[0] : m.fromMe ? conn.user.jid : m.sender
  let more = String.fromCharCode(8206);
  let done = '๐';
  m.react(done);
    let fkontak = { "key": { "participants":"0@s.whatsapp.net", "remoteJid": "status@broadcast", "fromMe": false, "id": "Halo" }, "message": { "contactMessage": { "vcard": `BEGIN:VCARD\nVERSION:3.0\nN:Sy;Bot;;;\nFN:y\nitem1.TEL;waid=${m.sender.split('@')[0]}:${m.sender.split('@')[0]}\nitem1.X-ABLabel:Ponsel\nEND:VCARD` }}, "participant": "0@s.whatsapp.net" }
    let name = await conn.getName(m.sender)
    if (!text) {
        let ps = groupMetadata.participants.map(v => v.id)
        let a = ps.getRandom()
        let b
        do b = ps.getRandom()
        while (b === a)

        if (command == 'futurarelacion') {    
            let caption = `๐ ุนูุงูุฉ ูุณุชูุจููุฉ ๐\n${toM(a)} ๐ ${toM(b)}\n\n๐ ูู ุฎูุงู ุงูุนูุงูุฉ ุจุงูุนูุงูุฉ\n*_${await ktnmbk.getRandom()}_*`
            await conn.reply(m.chat, caption, m, { mentions: conn.parseMention(caption) })
        }
    }

    if (isNaN(text)) {
        var number = text.split`@`[1]
    } else if (!isNaN(text)) {
        var number = text
    }

    if (!text && !m.quoted) return await conn.reply(m.chat, `ูุงุฐุงุ๐ค ูุฑุฌู ุฅุฑุณุงู ููุดู ุงููุณุชุฎุฏู ุฃู ุจุนุฏ ุงูุฃูุฑ`, m, fkontak)

    try {
        if (text) {
            var user = number + '@s.whatsapp.net'
        } else if (m.quoted.sender) {
            var user = conn.getName(m.quoted.sender)
        } else if (m.mentionedJid) {
            var user = number + '@s.whatsapp.net'
        }  
    } catch (e) {
    } finally {
        let users = m.isGroup ? participants.find(v => areJidsSameUser(v.jid == user)) : {}

        if (!users) return await conn.reply(m.chat, `ูู ูุชู ุงูุนุซูุฑ ุนูู ุงูุดุฎุต ุงููุทููุจ ๐ ูุฑุฌู ุงูุชุญูู ูู ุตุญุฉ ุงูุงุณู ูุฅุนุงุฏุฉ ุงููุญุงููุฉ`, m, fkontak)

        if (user === m.sender) return await conn.reply(m.chat, `ุฃููุ๐  ูุง ููููู ุฃู ุชุทูุจ ุชูุงุนุฏู ูููุณู`, m, fkontak)

        if (user === conn.user.jid) return await conn.reply(m.chat, `ุฃูุช ูุง ุชุณุชุทูุน ุฃู ุชุทูุจ ุงูุชูุงุนุฏ ูุฃูู ุจูุช ๐น`, m, fkontak)

        if (typeof global.db.data.users[user] == "undefined") return await conn.reply(m.chat, `ูู ูุชู ุงูุนุซูุฑ ุนูู ุงููุณุชุฎุฏู ุงููุทููุจ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช`, m, fkontak)

        let pacar = global.db.data.users[user].pasangan
        let spac = global.db.data.users[m.sender].pasangan
        let yo = conn.getName(m.sender)
        let tu = conn.getName(who)

        if (global.db.data.users[m.sender].pasangan != "" && global.db.data.users[global.db.data.users[m.sender].pasangan].pasangan == m.sender && global.db.data.users[m.sender].pasangan != user) {
            await conn.reply(m.chat, `ูุง ุดููู ูู ุฃูู ุชุชุณูู ๐๐ ุญูุซ ุฃู *${await conn.getName(spac)}* ูุฑุชุจุท ุญุงูููุง ุจ *${await conn.getName(global.db.data.users[m.sender].pasangan)}*\n\nูู ุชููุฑ ูู ุฅููุงุก ูุฐุง ุงูุนูุงูุฉุ ๐ค\nุฅุฐุง ูุงูุช ุฅุฌุงุจุชู ูุนูุ ูุงุณุชุฎุฏู *${usedPrefix}ุทุงูู @tag* ูุฅููุงุก ุนูุงูุชู ูุน *${await conn.getName(user)}*`, m, { contextInfo: { mentionedJid: [m.sender, who, user, global.db.data.users[m.sender].pasangan]}})
        } else if (global.db.data.users[user].pasangan != "") {

            if (pacar) {
                if (m.sender == pacar && global.db.data.users[m.sender].pasangan == user) return conn.reply(m.chat, `ุฃูุช ุจุงููุนู ูุน ${spac.split('@')[0]}`, m , { contextInfo: { mentionedJid: [spac]}})
                conn.reply(m.chat, `ูุง ููููู ุฃู ุชุทูุจ *${await conn.getName(user)}* ุญูุซ ุฃูู ูุฑุชุจุท ุญุงูููุง ุจ *${await conn.getName(pacar)}*`, m , { contextInfo: { mentionedJid: [m.sender, global.db.data.users[m.sender].pasangan]}})
            } else {

                global.db.data.users[m.sender].pasangan = user
                conn.reply(m.chat, `${await ktnmbk.getRandom()}\n\nุชู ุงุฑุณุงู ุทูุจ ุฅูู @${user.split('@')[0]}\n\n*ุฅูู ุงูุฃุจุฏ ุณูููู ุฃูุถู ุฃุฒูุงุฌ!*`, m , { contextInfo: { mentionedJid: [user]}})
            }	
        } else if (global.db.data.users[user].pasangan == m.sender) {
            global.db.data.users[m.sender].pasangan = user
            conn.reply(m.chat, `*ุงูู ูุจุฑูู* ุชูุช ุงูููุงููุฉ ุนูู ุทูุจ ุงูุนูุงูุฉ ุจูุฌุงุญ\n\n*ุณูููู ููููุง ุณุนูุฏูุง ูุฑุงุฆุนูุง ุฅุฐุงู!*`, m , { contextInfo: { mentionedJid: [user]}})
        } else {

            global.db.data.users[m.sender].pasangan = user
            await conn.reply(m.chat, `*${await ktnmbk.getRandom()}*\n\n*${await conn.getName(m.sender)}* ูุฏ ุงูุชุฑุจ ููู! ๐ณ\n\n*ุฅุฐุง ููุช ุชุฑุบุจ ูู ุงูุงุณุชูุฑุงุฑุ ุงุณุชุฎุฏู:*\n*โ ${usedPrefix}ูุจูู @${conn.getName(m.sender)}*\n\n*ูุฅุฐุง ููุช ูุง ุชุฑุบุจ ูู ุงูุงุณุชูุฑุงุฑุ ุงุณุชุฎุฏู:*\n*โ ${usedPrefix}rechazar @${conn.getName(m.sender)}*\n\n`, m, { contextInfo: { mentionedJid: [ who, m.sender, user ]}})
        }
    }
}

//handler.help = ['ุฒูุงุฌ']
//handler.command = /^(futurarelacion|pareja|elegirpareja|serpareja|sersupareja|couple|elegirpareja|ุฒูุฌ|ุฒูุงุฌ)$/i
handler.group = true

export default handler

let ktnmbk = [
    "ููุงู ูุญุธุงุช ูุง ุฃุญุจ ุฃู ุฃููู ูุญุฏู. ููููู ุฃูุถูุง ูุง ุฃุฑูุฏ ุฃู ูุฑุงูููู ุงูุฌููุนุ ุฃุฑูุฏู ููุท ุฃูุช",
    "ุฃุฏุฑูุช ููุชู ุฃูู ููุฒ ุทูุงู ูุฐุง ุงูููุช! ูุซู ูุง ููุช ุฃุจุญุซ ุนูู ุทูุงู ุงูููุช. ูู ุชุฑูุฏูู ุฃู ุชูููู ุญุจูุจุชูุ",
    "ุฃุดูุฑ ุนููู ูุฃู ูุฐู ุงูุนููู ูุงุฏุชูู ูุฃุฌูู",
    "ูู ูููููู ุฅุฑุณุงู ุณูุฑุชู ุงูุฐุงุชูุฉ ุฃู ูุงุ ูุฃููู ุฃุฑุบุจ ูู ุงูุชูุฏู ููููู ุญุจูุจุชู",
    "ูุณุช ุงูุฃุนุธูุ ููููู ูุชุฃูุฏ ุฃููู ูููููู ุฌุนูู ุณุนูุฏุฉ ุจุงูุญุจ ูุงูุงูุชูุงูุ ูู ุชูุงููููุ",
    "ุฃูุง ููุท ุดุฎุต ุนุงุฏู ูุฏูู ุงููุซูุฑ ูู ุงูุนููุจ ููุฏ ูุง ุฃุณุชุญู ุญุจูุ ููู ุฅุฐุง ููุช ุนูู ุงุณุชุนุฏุงุฏ ููุจููู ูุญุจูุจุ ุฃุนุฏู ุจุฃู ุฃูุนู ูู ุดูุก ูุฃุฌูู. ูู ุณุชูุจููู ุญุจูุ",
    "ุฃุฑูุฏ ููู ุดูุก. ุฃุนุฌุจุช ุจู ููุชุฑุฉ ุทูููุฉุ ููููู ูุง ุฃุฌุฑุค ุนูู ุงูููู. ูุฐููุ ูุฑุฑุช ููุท ุฅุฑุณุงู ุฑุณุงูุฉ. ูู ุชุฑูุฏ ุฃู ุชูููู ุญุจูุจุชูุ",
    "ุฃุฑูุฏ ููู ุดูุก ูู ุฃุชููู ูู ูุจุชู. ุฃุญุจูุ ูู ุชูุงูููู ุนูู ุฃู ุชูููู ุญุจูุจุชูุ",
    "ุฃุฑูุฏ ุฃู ุฃููู ุดุฎุต ููููู ุฌุนูู ุชุถุญููู ูุชุจุชุณููู ูู ููู. ูู ุชูุงูููู ุนูู ุฃู ุชูููู ุญุจูุจุชูุ",
    "ุฃุฑูุฏ ุฃู ุฃููู ุงูุดุฎุต ุงูุฐู ูููู ุฃู ูุฌุนูู ุชุจุชุณููู ูุชุถุญููู ุฏุงุฆููุง. ูู ุชูุงูููู ุนูู ุฃู ุชูููู ุญุจูุจุชูุ",
    "ุฃุฑูุฏ ุฃู ุฃุชุญุฏุซ ุจุฌุฏูุฉ ูุนู. ููุฐ ููุช ุทููู ุฃุฎูู ูุดุงุนุฑู ูู ูููุช ุฏุงุฆููุง ุฃููุฑ ููู. ุฅุฐุง ูู ููู ูุฏูู ูุงูุนุ ูู ุชูุงูููู ุนูู ุฃู ุชูููู ุญุจูุจุชูุ",
    "ุฃูุง ุฃูุธุฑ ุฅููู ูุฃุฑู ุจููุฉ ุญูุงุชู ุฃูุงู ุนููู",
    "ููุณ ุงูุนุฑุด ุฃู ุงูููุฒ ูู ูุง ุฃุจุญุซ ุนููุ ุจู ุงูุนูุฏุฉ ูุญุจู ูู ูุง ุฃุชููุงู ููู. ุงูุฅุฌุงุจุฉ ูุนู",
    "ุงูุญุจ ุงูุฐู ุฃุดุนุฑ ุจู ูุญูู ูุง ููุดูู ููู ูุฃู ูุฐุง ุงูุญุจ ุตุงุฏู ูู ุงูููุจ",
    "ุงูุญุจ ุงูุฐู ุฃุดุนุฑ ุจู ูุญูู ูู ุงูุฑูู ูู 5 ุฅูู 10. ูุง ููุฌุฏ ุซุงููุฉ. ุฃุฑูุฏู ุฃู ุชูููู ุงููุฑุฃุฉ ุงููุญูุฏุฉ ูู ููุจู",
    "ุฃู ุฑุฌู ูุชุฌุฑุฃ ุนูู ุฅูุฐุงุฆู. ููุง ุณุฃุนุชูู ุจูุ ุทุงููุง ุชุฑูุฏูู ุฃู ุชูููู ุญุจูุจุชู",
    "ุฃู ุดูุก ุนููุ ูู ุฃุดุนุฑ ุจุงูููู ููู ุฃุจุฏูุง. ูุฃู ุฃูุช ูู ุฌุงูุจูุ ูุฏูุชู ุงูุฃุฌูู ูู. ูู ุญุจูุจุชูุ ููุง ุจูุง",
    "ูุน ุฅุฐู ุงููู ูุจุฑูุฉ ุฃูู ูุฃุจูุ ูู ุชูุงูููู ุฃู ุชูููู ุญุจูุจุชู ุฃู ูุงุ",
    "ูุฅุฐุง ุฃุตุจุญูุง ุนุตุงุจุฉ ูุตูุตุ ุณุฑูุช ููุจู ูุฃูุช ุณุฑูุช ููุจู",
    "ุงูุณุนุงุฏุฉ ูู ุฃูู ูุฃูุง ุฃุตุจุญูุง ูุญู",
    "ุบุฏูุงุ ุฅุฐุง ูู ููุฌุญุ ูุณุฃููู ุจุงูุชุณุฌูู ูุชูููู ุญุจูุจุชู. ุงููุญููู ูุธููุฉ ูุฃููุฑ ุฏุงุฆููุง ููู",
    "ุฏุนูู ุฃุฌุนูู ุณุนูุฏุฉ ุฅูู ุงูุฃุจุฏ. ูู ูุง ุนููู ูุนูู ูู ุฃู ุชุญุจููู",
    "ูููู ูู ูุฑุญู ูุฑุญูุ ููุชูู ูู ุญุฒูู ุญุฒูู. ูููู ุงูุนุงูู ููู ููุ ููุท ุฃูุช ูู!",
    "ูููู ูุงุถูู ูุงุถูุ ููู ุจุงููุณุจุฉ ููุญุงุถุฑุ ูู ุณุชููููู ูุณุชูุจููุ",
    "ูู ููููู ุฃู ุชุนุทููู ุนููุงู ููุจูุ ูุจุฏู ุฃููู ุชุงูุช ูู ุนูููู",
    "ุฃูุช ุจุฌุงูุจู ุฏุงุฆููุง ุญุชู ุนูุฏูุง ุฃููู ูู ุฃุณูุฃ ุญุงูุงุชู",
    "ูุง ุฃุณุชุทูุน ุฃู ุฃุจุฏุฃ ูุฐุง ุฃููุงูุ ููููู ุณุฃุนุทูู ุฑูุฒูุง ูุฏู ุนูู ุฃูู ุชุนุฌุจูู ุจู. ุฅุฐุง ูููุช ูุฐุง ุงูุฑูุฒุ ูุณูููู ูุนูุง",
    "ุฃูุง ุฃุญูู ุฌุฏูุง ุฃู ุฃูุช ุฃูุงููุฉ ุฌุฏูุง ูุชุฌุนููู ุฃุญุจูุ",
    "ุฃุนูู ุฃููุง ุฃุตุฏูุงุก ููุฐ ูุชุฑุฉ ุทูููุฉ. ููู ูู ูููู ุฃู ุชุญุจูููุ ูููุง ูุงู ุฑุฏูุ ุณุฃูุจู. ุงูููู ูู ุงูุตุฏู ูู ุฃุนูุงู ููุจู",
    "ูุง ุฃุณุชุทูุน ุฃู ุฃุจุฏุฃ ูุฐุง ุฃููุงูุ ููููู ุณุฃุนุทูู ุฑูุฒูุง ูุฏู ุนูู ุฃูู ุชุนุฌุจูู ุจู. ุฅุฐุง ูููุช ูุฐุง ุงูุฑูุฒุ ูุณูููู ูุนูุง",
    "ุฃู ุฑุฌู ูุชุฌุฑุฃ ุนูู ุฅูุฐุงุฆู. ููุง ุณุฃุนุชูู ุจูุ ุทุงููุง ุชุฑูุฏูู ุฃู ุชูููู ุญุจูุจุชู",
    "ุฃูุช ุจุฌุงูุจู ุฏุงุฆููุง ุญุชู ุนูุฏูุง ุฃููู ูู ุฃุณูุฃ ุญุงูุงุชู",
    "ููุณุช ุงูุฃูุงูู ุงูุชู ูุฐูุจ ุฅูููุง ูู ุงูุชู ุชุฌุนููุง ุณุนุฏุงุกุ ุจู ุงูุฃุดุฎุงุต ุงูุฐูู ูููููู ูุนูุง",
    "ููุฏ ุฃุนุฌุจุช ุจู ููุฐ ุฃู ููุจุช ุธูุฑู ูู. ูู ููููู ุฃู ุชูููู ุญุจูุจุชูุ",
    "ูู ูููููู ุฃู ุฃุฌุนูู ุชุถุญููู ูู ูููุ ุฃุชููู ุฐูู",
    "ูู ูุง ุฃุฑูุฏู ูู ุฃู ุชูููู ุณุนูุฏุฉ ูุฑุงุถูุฉ",
    "ูู ูููููู ุฃู ุฃููู ุดูุฆูุงุ ุฃูุง ูุญุธูุธ ุฌุฏูุง ูุฃูู ูุนู"
]

Math.getRandom = function (min, max) {
    return Math.floor(Math.random() * (max - min)) + min;
}
Array.prototype.getRandom = function () {
    return this[Math.getRandom(0, this.length)];
}
